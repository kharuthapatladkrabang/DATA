// เปลี่ยนค่านี้เป็น URL ที่ Deploy แล้วของคุณโดยตรง
const EXTERNAL_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbzOpeTl3X_iwWxmkYD80vKaNhCLvKo2DVr5a4SaJusxQu-Rme6QwZiRRHa0qcMJpq4lKg/exec';

/**
 * ดึงข้อมูลรายการปุ่ม Studio
 */
async function getStudioListFromExternalAPI() {
    const url = new URL(EXTERNAL_WEB_APP_URL);
    url.searchParams.set('action', 'get_studio_list');

    try {
        const response = await fetch(url.toString(), {
            method: 'POST' // Apps Script API ใช้ POST
        });

        if (!response.ok) {
            throw new Error(`HTTP Status ${response.status}`);
        }

        const data = await response.json();
        if (data.success) {
            console.log("Studio List:", data.studioNames);
            return data.studioNames;
        } else {
            console.error("API Error:", data.message);
            return [];
        }
    } catch (error) {
        console.error("Fetch Error:", error);
        return [];
    }
}

/**
 * ดึงข้อมูล Geofence Config สำหรับ Studio ที่ระบุ
 * @param {string} studioName ชื่อ Studio ที่ต้องการ
 */
async function getGeofenceConfigFromExternalAPI(studioName) {
    const url = new URL(EXTERNAL_WEB_APP_URL);
    url.searchParams.set('action', 'get_geofence_config');
    url.searchParams.set('studio', studioName);

    try {
        const response = await fetch(url.toString(), {
            method: 'POST'
        });

        if (!response.ok) {
            throw new Error(`HTTP Status ${response.status}`);
        }

        const data = await response.json();
        if (data.success) {
            console.log(`Config for ${studioName}:`, data);
            return data;
        } else {
            console.error("API Error:", data.message);
            return null;
        }
    } catch (error) {
        console.error("Fetch Error:", error);
        return null;
    }
}

// ตัวอย่างการใช้งาน:
// getStudioListFromExternalAPI();
// getGeofenceConfigFromExternalAPI('Studio A');
